var Table,indexOf=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1};Table=function(){function Table(t){var e,i,o,l;this.request=null,this.existMore=!0,this.order="",this.filter={},this.actionsDiv=$("<div />"),this.menuDiv=$("<ul />"),this.table=$('<div class="table" />'),this.head=$('<div class="head" />'),this.body=$('<div class="body" />'),this.foot=$('<div class="foot" />'),this.onOrder=null,this.onFilter=null,this.onGetData=null,this.onRowSelect=null,this.onCloseRowContainer=null,this.current=null,swig.setFilter("hasValue",function(t){return"undefined"!=typeof t.value}),this.templates={actions:swig.compile('{% for action in actions %}{% if not action.element %}<button type="button" class="btn {{action.class}}" data-action="{{action.id}}">{{action.label}}</button>{% endif%}{% endfor %}'),menu:swig.compile('{% for action in actions %}<li data-action="{{action.id}}">{{action.label}}</li>{% endfor %}'),columns:swig.compile('<table><thead><tr>{% for i in Array.prototype.constructor.call(null, rows.columns) %}<th class="col-{{loop.index0}}"></th>{% endfor %}</tr></thead><tbody>{% for row in rows %}<tr>{% for column in row %}<td{% if column.attrs and column.attrs.class %} class="{{column.attrs.class}} {% if order and order.field == column.name %} order{% endif %}"{% else %}{% if order and order.field == column.name %} class="order"{% endif %}{% endif %}{% for attr, value in column.attrs %}{% if attr != "width" and attr != "class" %} {{attr}}="{{value}}"{% endif %}{% endfor %}>{% if column.label %}<label{% if column.name and column.order %} data-order="{{column.name}}" class="order{% if order and order.field == column.name %} {{order.sort}}{% endif %}"{% endif %}{% if column.label.key %} data-i18n="{{column.label.key}}">{{column.label.text}}{% else %}>{{column.label}}{% endif %}</label>{% endif %} {% if column.filter == "select" %}<select name="{{column.name}}">{% for option in column.filterData %}<option value="{{option.value}}"{% if column.filterValue and column.filterValue == option.value %} selected="selected"{% endif %}{% if option.label.key %} data-i18n="{{option.label.key}}">{{option.label.text}}{% else %}>{{option.label}}{% endif %}</option>{% endfor %}</select>{% elif column.filter == "date" or column.filter == "datetime" or column.filter == "time" %}{% if column.filter != "time" %}<div class="date-picker"><input autocomplete="off" type="text" name="{{column.name}}{% if column.filter == "datetime" %}[date]{% endif %}" value="{{column.filterValue}}"/></div>{% endif %}{% if column.filter != "date" %}<div class="time-picker"><input autocomplete="off" type="text" name="{{column.name}}{% if column.filter == "datetime" %}[time]{% endif %}" value="{{column.filterValue}}"/></div>{% endif %}{% elif column.filter == "text" %}<input autocomplete="off" type="text" name="{{column.name}}" value="{{column.filterValue}}"/>{% elif column.filter == "number" or column.filter == "comparison" %}<input autocomplete="off" type="text" name="{{column.name}}" class="number{% if column.filter == "comparison" %} comparison{% if column.extendedFilter %} extended{% endif %}{% endif %}" value="{{column.filterValue}}"/>{% elif column.filter %}<input autocomplete="off" type="{{column.filter}}" name="{{column.name}}" value="{{column.filterValue}}"/>{% endif %}{% if column.type %}{% if column.type == "checkbox" %}<input type=\'checkbox\'{% if column.class %} class="{{column.class}}"{% endif %}/>{% endif %}{% endif %}</td>{% endfor %}</tr>{% endfor %}</tbody></table>'),rows:swig.compile('{% if rows.head %}<table><thead><tr>{% for i in Array.prototype.constructor.call(null, rows.columns) %}<th class="col-{{loop.index0}}"></th>{% endfor %}</tr></thead><tbody>{% endif %}{% for row in rows %}<tr{% if row.attrs %}{% for attr, value in row.attrs %} {{attr}}="{{value}}"{% endfor %}{% endif %}>{% for cell in row.cells %}<td {% if cell.actions %} style="overflow: visible" {% endif %}{% if cell.attrs %}{% for attr, value in cell.attrs %} {{attr}}="{{value}}"{% endfor %}{% endif %}{% if cell|hasValue %}{% if not cell.safe %} title="{{cell.value}}"{% endif %}>{% if cell.safe %}{{cell.value|safe}}{% else %}{{cell.value}}{% endif %}{% else %} title="{{cell}}">{{cell}}{% endif %}{% if cell.type %}{% if cell.type == "checkbox" %}<input type=\'checkbox\' {% if cell.checked == \'1\' %} checked="true"{% endif %} {% if cell.class %} class="{{cell.class}}"{% endif %}/>{% endif %}{% endif %}{% if cell.actions %}<div class="option-wrapper dropdown cell_actions"><span class="dropdown-toggle glyphicon glyphicon-option-vertical btn" data-toggle="dropdown"></span><ul class="dropdown-menu">{% for action in cell.actions %}<li><button data-id="{{ action.id }}" {% if action.onclick %} onClick="{{ action.onclick }}" {% endif %} {% if action.label.key %} data-i18n="{{ action.label.key }}" > {{ action.label.text }} {% else %}>{{ action.label }} {% endif %} </button></li>{% endfor %}</ul></div>{% endif %}</td>{% endfor %}</tr>{% endfor %}{% if rows.head %}</tbody></table>{% endif %}'),foot:swig.compile('<table><thead><tr>{% for i in Array.prototype.constructor.call(null, rows.columns) %}<th class="col-{{loop.index0}}"></th>{% endfor %}</tr></thead><tbody>{% for row in rows %}<tr{% if row.attrs %}{% for attr, value in row.attrs %} {{attr}}="{{value}}"{% endfor %}{% endif %}>{% for cell in row.cells %}<td{% if cell.attrs %}{% for attr, value in cell.attrs %} {{attr}}="{{value}}"{% endfor %}{% endif %}{% if cell|hasValue %}{% if not cell.safe %} title="{{cell.value}}"{% endif %}>{% if cell.safe %}{{cell.value|safe}}{% else %}{{cell.value}}{% endif %}{% else %} title="{{cell}}">{{cell}}{% endif %}</td>{% endfor %}</tr>{% endfor %}</tbody><tfoot><tr><th colspan="{{rows.columns}}"><div class="spinner"><div></div><div></div><div></div><div></div></div></th></tr></tfoot></table>')},o=this.constructor.defaults;for(i in o)l=o[i],this[i]=l;for(e in t)e in this&&(this[e]=t[e]);this.tableBinds()}return Table.VERSION="1.2.0",Table.defaults={start:0,length:100,loadMoreLength:50,fromBottomNextPage:50,attrs:{},actions:[],columns:[],footer:[],rows:[],url:"",datePickerOptions:{format:"mm/dd/yyyy",showOnFocus:!1,autoclose:!0,keyboardNavigation:!1,forceParse:!1},timePickerOptions:{timeFormat:"HH:mm"},showDefaultOrder:!1,editedNotification:!0,contextMenu:!0,selectable:!0,selectFirst:!1,defaultAction:null,scrollAlign:"right",arrowNavigation:!1,height:null,heightOfParent:null,MSSQLPagination:!1,filterTimeOut:300,autoRefresh:!0,margin:null},Table.prototype.getData=function(){var t,e,i,o,l;if(o=this,t={start:this.start,length:o.start?o.loadMoreLength:o.length},this.order&&(t.ordering=this.order),this.filter){i=this.filter;for(e in i)l=i[e],t[e]=l}o.start&&null!=this.MSSQLData&&(t.lastRow=this.MSSQLData),this.existMore&&(this.table.addClass("loading"),0===t.start&&(t.addLog=!0),this.request=$.getJSON(this.url,t,function(t){return o.table.removeClass("loading"),o.request=null,o.MSSQLPagination&&(o.MSSQLData=t[t.length-1]),null!=o.onGetData&&(o.onGetData=o.makeFunction(o.onGetData),t=o.onGetData(t,o)),o.renderRows(t,!!o.start),!t.length||t.length<(o.start?o.loadMoreLength:o.length)?o.existMore=!1:o.start+=t.length}).always(function(t){BaseManager.serverError(t.responseText),o.table.removeClass("loading"),o.request=null}))},Table.prototype.nextPage=function(){null==this.request&&this.getData()},Table.prototype.resetTable=function(){null!=this.request&&this.request.abort(),this.request=null,this.start=0,this.existMore=!0,this.body.html(""),this.getData(),this.updateActions()},Table.prototype.columnsBinds=function(){this.orderBind(),this.filterBind()},Table.prototype.filterBind=function(){var t,e,i,o;i=this,e=null,null!=$.fn.datepicker&&(t=$.extend({},this.datePickerOptions),this.head.find(".date-picker input").each(function(){var e,i;i=$(this),i.datepicker(t),i.addClass("hasDatePicker"),e=$("<button />",{type:"button","class":"datepicker-trigger",tabIndex:-1}),e.click(function(){i.datepicker("show"),i.focus()}),i.after(e)}),this.head.find(".date-picker .hasDatePicker").on("change keyup.table",function(t){var o,l;o=$(this).val(),"keyup"===t.type&&13!==(l=t.keyCode)&&9!==l&&0!==o.length&&o.length!==i.datePickerOptions.format.length||(0===o.length&&$(this).datepicker("hide"),null!=i.datePickerOptions.datePickerToFormat?(e=i.datePickerOptions.datePickerToFormat(o),"Invalid Date"===e||null==e?e=null:("keyup"!==t.type||t.ctrlKey||17===t.keyCode||$(this).datepicker("setDate",e),e instanceof Date&&(e=e.toISOString()))):e=o,i.doFilter(this,e))}),this.head.find(".date-picker .hasDatePicker").on("keydown.table blur",function(t){var e,o,l,n,s,a,r,d,c,h,u,f,p,m;if("blur"===t.type||"keydown"===t.type&&(13===(u=t.keyCode)||9===u)){if(h=new Date,n={d:"",m:"",y:""},s=i.datePickerOptions.format.replace(/[^\w]/g,""),m=$(this).val(),m.match(/^(\+|-)\d+$/g))h.setDate(h.getDate()+parseInt(m));else if(m.match(/^\d+$/)){for(a=r=0,c=s.length;r<c;a=++r)e=s[a],a<m.length&&(n[e]+=m[a]);if(4!==n.y.length){for(p="",a=d=0,f=4-n.y.length;0<=f?d<f:d>f;a=0<=f?++d:--d)p+=h.getFullYear().toString()[a];n.y=p+n.y}}else{if(!m.match(/^((\+|-)(\d+)(d|m|y)){1,3}$/gi))return;for(;o=m.match(/((\+|-)(\d+)(d|m|y))/i);)o=o[0],m=m.replace(o,""),l=parseInt(o.slice(0,-1)),"d"===o.toLowerCase().slice(-1)&&h.setDate(h.getDate()+l),"m"===o.toLowerCase().slice(-1)&&h.setMonth(h.getMonth()+l),"y"===o.toLowerCase().slice(-1)&&h.setFullYear(h.getFullYear()+l)}!n.d&&$(this).hasClass("no-day")&&(n.d=1),n.d&&h.setDate(parseInt(n.d)),n.m&&h.setMonth(parseInt(n.m)-1),n.y&&h.setFullYear(parseInt(n.y)),$(this).datepicker("setDate",h),$(this).datepicker("update"),$(this).trigger("change")}})),null!=$.fn.timepicker&&(o=$.extend({},this.timePickerOptions),o.showOn="button",this.head.find(".time-picker input").timepicker(o),this.head.find(".time-picker .ui-datepicker-trigger").attr("tabIndex",-1),null!=o.showSecond&&o.showSecond&&this.head.find(".time-picker").addClass("seconds"),this.head.find(".time-picker input").on("change keyup.table",function(t){var o;o=$(this).val(),("keyup"!==t.type||null!=t.keyCode&&13===t.keyCode||!o.length||o.length===i.timePickerOptions.timeFormat.length)&&(e=null!=i.timePickerOptions.timePickerToFormat?i.datePickerOptions.datePickerToFormat(o):o,i.doFilter(this,e,!1))})),this.head.find("input").on("focus.table",function(){$(this).select()}),this.head.find("input").on("keypress.table",function(t){var e,i,o;if(t.charCode&&!$(this).parent().hasClass("date-picker")&&!$(this).parent().hasClass("time-picker")&&$(this).hasClass("number")&&(e=t.which||t.keyCode,e<48||e>57)){if(o=$(this).val(),$(this).hasClass("comparison")&&(!o.match(/\./)&&46===e||(!o.match(/[=><]/)||$(this).hasClass("extended")&&o.match(/([=><]+)/g)&&("<="===(i=o.match(/([=><]+)/g)[0]+String.fromCharCode(e))||"<>"===i||">="===i))&&(62===e||61===e||60===e)))return;return!1}}),this.head.find("input").on("keyup.table",function(){$(this).parent().hasClass("date-picker")||$(this).parent().hasClass("time-picker")||(e=$(this).val(),i.doFilter(this,e,!1))}),this.head.find("select").on("change",function(){i.doFilter(this,$(this).val())}),this.head.find("input:checkbox").on("change",function(){this.className.includes("for_bi")||i.doFilter(this,$(this).prop("checked"))})},Table.prototype.doFilter=function(t,e,i){var o,l,n,s;null==i&&(i=!0),n=$.extend(!0,{},this.filter),l=$(t).attr("name"),s=this,null==this.timeoutBind&&(this.timeoutBind=null),(null==this.onFilter||(o=this.onFilter(t,e),null==o||o))&&(null==e||e||(e=null),null!=e?this.filter[l]=e:delete this.filter[l],n[l]!==this.filter[l]&&this.autoRefresh&&(clearTimeout(this.timeoutBind),i?s.resetTable():this.timeoutBind=setTimeout(function(){s.resetTable()},s.filterTimeOut)))},Table.prototype.orderBind=function(){var t;t=this,this.head.find("label.order").on("click.table",function(){var e,i,o;return!t.request&&(e=t.order,i=$(this).data("order"),o=t.order.indexOf(i),t.head.find("label.order").removeClass("asc desc"),t.head.find("label.order").parent().removeClass("order"),o!==-1?o?(t.order=i,$(this).addClass("asc")):(t.order="-"+i,$(this).addClass("desc")):(t.order=i,$(this).addClass("asc")),$(this).parent().addClass("order"),null!=t.onOrder?t.onOrder(t.order):e!==t.order&&t.resetTable(),!1)})},Table.prototype.tableBinds=function(){var t,e,i,o,l,n,s;if(s=this,this.bindActions(),this.contextMenu&&this.body.on("contextmenu.table","tr:not(.row-content)",function(t){return s.menu(this,t),!1}),this.selectable&&this.body.on("mousedown.table","tr:not(.row-content)",function(){if(!$(this).closest(".row-content").length)return null==s.request&&void(s.rowSelect($(this).index()-$(this).prevAll(".row-content").length,this)&&($(s.body).find("tr").removeClass("active"),$(this).addClass("active")))}),this.defaultAction&&this.actions)for(n=this.actions,o=0,l=n.length;o<l;o++)t=n[o],t.id===this.defaultAction&&(i=t,e=this.actionsDiv,this.body.on("dblclick.table","tr:not(.row-content)",function(){return null==s.request&&(document.getSelection().removeAllRanges(),void(e.find("[data-action="+i.id+"]").length?e.find("[data-action="+i.id+"]").trigger("click.table"):i.callback(s.rows[s.current],s)))}));this.body.on("scroll.table",function(){var t,e,i,o,l,n;s.body.find("tr.row-content").find("form").length&&(n={top:s.body.position().top,bottom:s.body.position().top+s.body.height()},s.body.find("tr.row-content").find("form").find(".error").each(function(){var t,e;e=$(this).position().top,t=$(this).find(".error-text"),e>n.top&&e+t.height()<n.bottom?t.css("top",e):t.css("top",-9999)})),e=s.body.position(),t=s.body.height(),s.body.find("tbody tr").length&&(l=s.body.find("tbody tr:last").position(),o=s.body.find("tbody tr:last").outerHeight(),i=l.top+o-(t+e.top),i<s.fromBottomNextPage&&i>=0&&s.nextPage())}),$("body").off("keydown.table"),$("body").on("keydown.table",function(t){var e,i,o,l,n,s,a,r;38!==t.keyCode&&40!==t.keyCode&&13!==t.keyCode||$(t.target).is("input, textarea, select")||(r=$(".table-data.arrow-navigation:visible"),r.find(".body tr.active").length&&(r=r.find(".body tr.active").closest(".table-data"),r=r.filter(".active").length?r.filter(".active"):r.first(),n=$(".body",r),a=$("tr.active",r),a.length&&(13===t.keyCode?a.trigger("dblclick.table"):(s=38===t.keyCode?a.prevAll().not(".row-content"):a.nextAll().not(".row-content"),s=s.first(),s.length&&(s.trigger("mousedown.table"),i=n.height(),e=s.height(),l=n.scrollTop(),o=s.offset().top-n.offset().top,o<0?n.scrollTop(l+o):o+e>i&&n.scrollTop(o-i+l+e))))))})},Table.prototype.menu=function(t,e){var i,o,l,n,s,a,r,d,c;if(this.contextMenu){for(this.menuDiv.html(this.templates.menu({actions:this.actions})),d=this,a=this.actions,o=0,n=a.length;o<n;o++)i=a[o],this.menuDiv.attr({id:"contextmenu"}).find("[data-action="+i.id+"]").data("action-data",i).on("mousedown.table",function(){i=$(this).data("action-data"),null!=i.callback&&i.callback(d.rows[d.current],d)}),s=this.menuDiv.find("[data-action="+i.id+"]"),null==i.global&&!i.global&&null!=$(t).data("action-disabled")&&(r=i.id,indexOf.call($(t).data("action-disabled"),r)>=0)?s.addClass("disabled"):s.removeClass("disabled");$(document.body).append(this.menuDiv),c=e.clientY,l=e.clientX,c+this.menuDiv.height()+5>$(document).height()&&(c-=this.menuDiv.height()),l+this.menuDiv.width()+5>$(document).width()&&(l-=this.menuDiv.width()),this.menuDiv.css({top:c,left:l}),$(document).on("mousedown.table",function(){return $("#contextmenu").remove(),$(document).unbind("mousedown.table")})}},Table.prototype.rowSelect=function(t,e){return this.current=t,this.updateActions(e),null==this.onRowSelect||this.onRowSelect(this.rows[t],e,this)},Table.prototype.addRowContainer=function(t,e,i){var o,l,n;if(null==e&&(e=!1),null==i&&(i=!0),l=$("<tr />"),o=$('<td colspan="'+this.cols+'" />'),o.html(t),l.addClass("row-content").html(o),e){if(this.body.find("tr.active").next().hasClass("row-content"))return;l.addClass("pinned"),l.insertAfter(this.body.find("tr.active")),this.updateActions(this.body.find("tr.active"))}else this.body.find("tbody").length||(n=[],n.columns=this.cols,n.head=!0,this.body.html(this.templates.rows({rows:n}))),this.body.find("tbody").prepend(l);return i&&this.scrollRowContainer(l),l},Table.prototype.scrollRowContainer=function(t){var e;this.rowResize(),e=this.body.position(),t.hasClass("pinned")&&(e.top+=this.body.find("tr.active").height()),this.body.scrollTop(this.body.scrollTop()+(t.position().top-e.top))},Table.prototype.closeRowContainer=function(t,e){var i,o,l,n,s;if(null==e&&(e=!1),s=this,n=this.body.children("table").children("tbody").children("tr"),this.editedNotification||(e=!0),n.length>t){if(l=n.eq(t),o=function(){var t;t=l.prev(".active"),l.remove(),t.length&&s.updateActions(t),s.body.find("tbody tr").length||s.body.html(""),s.rowResize()},null!=this.onCloseRowContainer){if(i=this.onCloseRowContainer(t,e,this,l,o),null!=i&&!i)return!1}else if(!e&&l.is(".edited")&&!confirm("You are sure?\n Added/edited data not was saved"))return!1;o()}return!0},Table.prototype.lockAction=function(t,e,i){var o,l,n,s,a;for(null==e&&(e=null),null==i&&(i=!1),a=this.actions,n=0,s=a.length;n<s;n++)if(o=a[n],o.id===t)return l=null!=o.element?$(o.element):this.actionsDiv.find("[data-action="+o.id+"]"),l.hasClass("locked")&&(null==e||null!=e&&!e)?l.removeClass("locked"):l.addClass("locked"),void(i?l.addClass("disabled"):l.removeClass("disabled"))},Table.prototype.updateActions=function(t){var e,i,o,l,n,s,a,r,d,c;for(null==t&&(t=null),null!=t?(l=null!=$(t).data("action-disabled")?$(t).data("action-disabled"):null,o=null!=$(t).data("action-content-disabled")&&$(t).next(".row-content").length?$(t).data("action-content-disabled"):null):l=o=null,r=this.actions,n=0,s=r.length;n<s;n++)e=r[n],i=null!=e.element?$(e.element):this.actionsDiv.find("[data-action="+e.id+"]"),a=this.menuDiv.find("[data-action="+e.id+"]"),null!=this.request||null==e.global&&!e.global&&(null==t||null!=t&&(null!=l&&(d=e.id,indexOf.call(l,d)>=0)||null!=o&&(c=e.id,indexOf.call(o,c)>=0)))?(i.addClass("disabled"),a.addClass("disabled")):(i.removeClass("disabled"),a.removeClass("disabled"))},Table.prototype.renderActions=function(){var t,e,i,o,l;for(this.actionsDiv.addClass("table-actions"),o=[],l=this.actions,e=0,i=l.length;e<i;e++)t=l[e],null==t.element&&o.push(t);return this.actionsDiv.html(this.templates.actions({actions:o})),this.bindActions(),this.updateActions(),this.actionsDiv},Table.prototype.bindActions=function(){var t,e,i,o,l,n;for(n=this,l=this.actions,i=0,o=l.length;i<o;i++)t=l[i],e=null!=t.element?$(t.element):this.actionsDiv.find("[data-action="+t.id+"]"),e.data("action-data",t).off("click.table"),e.data("action-data",t).on("click.table",function(){$(this).hasClass("disabled")||$(this).hasClass("locked")||(t=$(this).data("action-data"),null!=t.callback&&t.callback(n.rows[n.current],n))})},Table.prototype.renderRows=function(t,e){var i,o,l,n;for(null==e&&(e=!1),e||(this.rows=[],this.body.scrollTop(0),this.updateActions()),i=[],o=0,l=t.length;o<l;o++)n=t[o],Array.isArray(n)?i.push({attrs:null,cells:n}):i.push(n);return Array.prototype.push.apply(this.rows,i),i.columns=this.cols,this.rows.length?i.length&&(e?this.body.find("tbody").append(this.templates.rows({rows:i})):(i.head=!0,this.body.html(this.templates.rows({rows:i})))):this.body.html(""),this.table.is(":visible")&&this.rowResize(),!e&&this.selectable&&this.selectFirst&&this.rows.length&&this.body.find("tbody tr:first").trigger("mousedown.table"),$("[title]",this.table).each(function(t,e){if(!(e.offsetWidth<e.scrollWidth))return $(e).removeAttr("title")}),this.body},Table.prototype.columnRule=function(t,e){var i,o,l,n,s,a,r,d,c,h,u,f,p;if(null==e&&(e=null),d="#"+this.table.attr("id")+" table > thead > tr > .col-"+t,$("#table_columns").length||$("head").append($("<style />").attr({id:"table_columns",type:"text/css"})),document.styleSheets)for(f=document.styleSheets,n=0,a=f.length;n<a&&(u=f[n],"table_columns"!==$(u.ownerNode).attr("id"));n++);for(o=u.cssRules?u.cssRules:u.rules,l=!1,c=s=0,r=o.length;s<r;c=++s)if(h=o[c],null!=h.selectorText&&h.selectorText.toLowerCase()===d){l=!0;break}if(null==e)return void(l&&(u.cssRules?u.deleteRule(c):u.removeRule(c)));if(l||(c=o.length,l=!0,u.addRule?u.addRule(d,null,c):u.insertRule(d+" {}",c)),l)for(i in e)p=e[i],o[c].style[i]=p},Table.prototype.columnsResize=function(){var t,e,i,o,l,n,s,a,r,d,c,h,u,f,p,m,b,y,g,v,w,k,$,C,x,T,D,R,A;if(D=this,n=0,l=[],T=[],this.cols=0,this.columns.length)for(T=Array.isArray(this.columns[0])?this.columns:[this.columns],w=T[0],a=0,c=w.length;a<c;a++)i=w[a],this.cols+=null!=i.attrs&&null!=i.attrs.colspan?i.attrs.colspan:1;for(T.columns=this.cols,s=r=0,k=this.cols-1;0<=k?r<=k:r>=k;s=0<=k?++r:--r)D.columnRule(s);for(this.table.css({width:""}),this.head.css({display:"inline-block",width:"auto"}).find("table").css({width:"auto"}),this.body.hide(),this.foot.hide(),R=this.table.width(),this.head.css({display:"",width:""}).find("table").css({width:""}),this.body.show(),this.foot.show(),this.table.width(R),$=["fixed","percent","auto"],d=0,h=$.length;d<h;d++)for(t=$[d],m=0,u=T.length;m<u;m++)for(x=T[m],s=-1,y=0,f=x.length;y<f;y++){if(i=x[y],s++,l.length<=s)for(g=0,C=l.length-s;0<=C?g<=C:g>=C;0<=C?g++:g--)l.push({rowspan:0});l[s].rowspan&&(l[s].rowspan--,s++,l[s].rowspan&&(l[s].rowspan--,s++)),null!=i.attrs&&null!=i.attrs.rowspan&&1!==i.attrs.rowspan&&(l[s].rowspan+=i.attrs.rowspan-1),null==i.attrs||null==i.attrs.colspan||1===i.attrs.colspan?(null==l[s].width?(A="auto",b="initial",null!=i.attrs&&(null!=i.attrs.width&&(A=i.attrs.width),null!=i.attrs.minWidth&&(b=i.attrs.minWidth))):(A=l[s].width,b=l[s].minWidth),"fixed"===t&&A.toString().match(/^\d+(px)?$/)?(A=parseInt(A),R-=A,n++):"percent"===t&&A.toString().match(/^\d+%$/)?(A=parseInt(R*(parseFloat(A)/100)),n++):"auto"===t&&"auto"===A&&(A=parseInt(R*(1/(this.cols-n)))),l[s].width=A,l[s].minWidth=b):s+=i.attrs.colspan-1}for(this.table.css({paddingRight:R-parseInt(R*(1/(this.cols-n)))*(this.cols-n)}),e=v=0,p=l.length;v<p;e=++v)o=l[e],D.columnRule(e,{width:o.width+"px",minWidth:o.minWidth+(isNaN(parseInt(o.minWidth))?"":"px")});this.head.width()<this.head.find("table").width()&&this.table.width(this.head.find("table").width()),this.body.getNiceScroll().length||this.rowResize()},Table.prototype.rowResize=function(){var t;null!=this.height?(this.table.css("maxHeight",this.height),t=this.table.height()-this.head.height()-this.foot.height()):this.body.height()&&(this.body.css("display","none"),t=parseInt(this.table.closest(this.heightOfParent).height())-(parseFloat(this.table.outerHeight())+(this.body.is(":empty")?1:0)-(null!=this.margin?this.margin:0))),this.body.css({maxHeight:t?t:"",display:"block"}),this.body.get(0).scrollHeight>t?this.body.getNiceScroll().length?this.body.getNiceScroll().resize():this.body.niceScroll({horizrailenabled:!1,cursoropacitymin:1,railalign:this.scrollAlign,enablekeyboard:!this.arrowNavigation,cursorwidth:3,railpadding:{top:1,right:1,left:1,bottom:1}}):this.body.getNiceScroll().remove()},Table.prototype.renderColumns=function(t){var e,i,o,l,n,s;if(this.columns=t,l=null,s=[],this.cols=0,this.columns.length)for(s=Array.isArray(this.columns[0])?this.columns:[this.columns],n=s[0],i=0,o=n.length;i<o;i++)e=n[i],this.cols+=null!=e.attrs&&null!=e.attrs.colspan?e.attrs.colspan:1;return s.columns=this.cols,this.showDefaultOrder&&this.order&&(l={field:this.order.substr(!this.order.indexOf("-")),sort:this.order.indexOf("-")?"asc":"desc"}),this.head.html(this.templates.columns({rows:s,order:l})),this.columnsBinds(),this.head},Table.prototype.renderFooter=function(t){var e,i,o,l,n;if(this.footer=t,n=[],this.footer.length)for(o=this.footer,e=0,i=o.length;e<i;e++)l=o[e],Array.isArray(l)?n.push({attrs:null,cells:l}):n.push(l);return n.columns=this.cols,this.foot.html(this.templates.foot({rows:n})),this.foot},Table.prototype.uid=function(){return Math.floor(4294967296*(1+Math.random())).toString(16).substring(1)},Table.prototype.render=function(){var t,e;for(t=JSON.parse(JSON.stringify(this.attrs)),null==t.id&&(t.id="uid_"+this.uid());$("#uid_"+this.attrs.id).length;)t.id="uid_"+this.uid();return null!=t["class"]&&(this.table.addClass(t["class"]),delete t["class"]),this.table.attr(t).addClass("table-data scroll-"+this.scrollAlign+(this.selectable?" selectable":"")+(this.arrowNavigation?" arrow-navigation":"")),this.renderColumns(this.columns),this.renderRows(this.rows),this.renderFooter(this.footer),this.table.append(this.head),this.table.append(this.body),this.table.append(this.foot),e=this,$(window).on("resize.table",function(){e.table.is(":visible")&&(e.columnsResize(),e.rowResize())}),this.table},Table.prototype.makeFunction=function(func){var e;if("function"==typeof func)return func;if("string"==typeof func)try{eval("func = "+func)}catch(error){e=error,console.error("function parse exception:",e)}else func=function(){};return func},Table}();
//# sourceMappingURL=Table.min.js.map
